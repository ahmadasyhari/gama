"use strict";(self["webpackChunkresep_bunda"]=self["webpackChunkresep_bunda"]||[]).push([[4473],{4473:(e,n,r)=>{r.r(n),r.d(n,{default:()=>h});var a=r(3144),t=r(124),u=r(8534),l=(r(1249),r(3210),r(6252)),i=r(2262),o=r(4797),c=r(6100),s=r(316),d=r(6708),f=r(6693),p=r(5856),m={class:"profile-picture-container"},v=["src"],g=(0,l._)("label",{for:"file-upload",class:"upload-button"},"Ganti Foto Profil",-1);const k={__name:"HalamanSetting",setup:function(e){var n=r(6706),k=(0,c.ad)(p.H),U=(0,d.cF)(p.H),h=(0,i.iH)(""),w=(0,i.iH)(""),b=(0,i.iH)(""),x=(0,i.iH)(""),S=(0,i.iH)(""),W=(0,i.iH)(""),_=(0,i.iH)(n),Z=(0,i.iH)([]),H=(0,i.iH)({isOpen:!1,message:"",duration:2e3,color:"success"}),R=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var r,a,u,l;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=(0,s.v0)(p.H),a=r.currentUser,a){e.next=5;break}return K("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 5:return e.prev=5,e.next=8,(0,c.QT)((0,c.JU)(k,"users",a.uid));case 8:u=e.sent,u.exists()?(l=u.data(),h.value=l.fullName||"",w.value=l.email||"",b.value=l.username||"",x.value=l.kelas||"",S.value=l.role||"",_.value=l.profilePicture||n,W.value=l.qrCode||""):K("Data pengguna tidak ditemukan","danger"),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](5),console.error("Error fetching user data:",e.t0),K("Terjadi kesalahan saat mengambil data pengguna","danger");case 16:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,c.PL)((0,c.hJ)(k,"kelas"));case 2:n=e.sent,Z.value=n.docs.map((function(e){return(0,a.Z)({id:e.id},e.data())}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.mR.checkPermission({force:!0});case 3:return e.next=5,f.mR.hideBackground();case 5:return e.next=7,f.mR.startScan();case 7:n=e.sent,n.hasContent&&(W.value=n.content,K("QR Code berhasil dipindai","success")),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.error("Error scanning QR code:",e.t0),K("Error scanning QR code","danger");case 15:return e.prev=15,f.mR.showBackground(),f.mR.stopScan(),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[0,11,15,19]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n,r;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=(0,s.v0)(p.H),r=n.currentUser,r){e.next=5;break}return K("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 5:if(""!==W.value.trim()){e.next=8;break}return K("Kode QR tidak boleh kosong","danger"),e.abrupt("return");case 8:return e.prev=8,e.next=11,(0,c.r7)((0,c.JU)(k,"users",r.uid),{qrCode:W.value});case 11:K("Kode QR berhasil didaftarkan","success"),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](8),console.error("Error registering QR code:",e.t0),K("Gagal mendaftarkan kode QR","danger");case 18:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(){var n,r;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=(0,s.v0)(p.H),r=n.currentUser,r){e.next=5;break}return K("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 5:return e.prev=5,e.next=8,(0,c.r7)((0,c.JU)(k,"users",r.uid),{fullName:h.value,email:w.value,username:b.value,kelas:x.value,profilePicture:_.value});case 8:K("Informasi pengguna berhasil diperbarui","success"),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](5),console.error("Error updating user info:",e.t0),K("Gagal memperbarui informasi pengguna","danger");case 15:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,u.Z)((0,t.Z)().mark((function e(n){var r,a,u,l,i;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=n.target.files[0],r){e.next=3;break}return e.abrupt("return");case 3:if(a=(0,s.v0)(p.H),u=a.currentUser,u){e.next=8;break}return K("Pengguna tidak terautentikasi","danger"),e.abrupt("return");case 8:return l=(0,d.iH)(U,"profile_pictures/".concat(u.uid)),e.prev=9,e.next=12,(0,d.KV)(l,r);case 12:return e.next=14,(0,d.Jt)(l);case 14:return i=e.sent,_.value=i,K("Foto profil berhasil diunggah","success"),e.next=19,(0,c.r7)((0,c.JU)(k,"users",u.uid),{profilePicture:i});case 19:e.next=25;break;case 21:e.prev=21,e.t0=e["catch"](9),console.error("Error uploading profile picture:",e.t0),K("Gagal mengunggah foto profil","danger");case 25:case"end":return e.stop()}}),e,null,[[9,21]])})));return function(n){return e.apply(this,arguments)}}(),K=function(e,n){H.value={isOpen:!0,message:e,duration:2e3,color:n}},G=function(e){R(),Q(),e.target.complete()};return(0,l.bv)((function(){R(),Q()})),function(e,r){return(0,l.wg)(),(0,l.j4)((0,i.SU)(o._i),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.Gu),{mode:"ios"},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.sr),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.wd),null,{default:(0,l.w5)((function(){return[(0,l.Uk)("Pengaturan")]})),_:1}),(0,l.Wm)((0,i.SU)(o.oU),{slot:"start","default-href":"/"})]})),_:1})]})),_:1}),(0,l.Wm)((0,i.SU)(o.W2),{fullscreen:!0},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.nJ),{slot:"fixed",onIonRefresh:r[0]||(r[0]=function(e){return G(e)})},{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.Wo))]})),_:1}),(0,l.Wm)((0,i.SU)(o.W2),{class:"ion-padding"},{default:(0,l.w5)((function(){return[(0,l._)("div",m,[(0,l._)("img",{src:_.value||(0,i.SU)(n),alt:"Profile Picture",class:"profile-picture"},null,8,v),g,(0,l._)("input",{id:"file-upload",type:"file",onChange:C,accept:"image/*"},null,32)]),(0,l.Wm)((0,i.SU)(o.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Nama Lengkap")]})),_:1}),(0,l.Wm)((0,i.SU)(o.pK),{modelValue:h.value,"onUpdate:modelValue":r[1]||(r[1]=function(e){return h.value=e})},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(o.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Email")]})),_:1}),(0,l.Wm)((0,i.SU)(o.pK),{modelValue:w.value,"onUpdate:modelValue":r[2]||(r[2]=function(e){return w.value=e}),type:"email"},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(o.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Username")]})),_:1}),(0,l.Wm)((0,i.SU)(o.pK),{modelValue:b.value,"onUpdate:modelValue":r[3]||(r[3]=function(e){return b.value=e})},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(o.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Role")]})),_:1}),(0,l.Wm)((0,i.SU)(o.pK),{modelValue:S.value,"onUpdate:modelValue":r[4]||(r[4]=function(e){return S.value=e}),readonly:""},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(o.YG),{style:{color:""},onClick:y,expand:"block",color:"primary"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Perbarui Informasi Pengguna")]})),_:1}),(0,l.Wm)((0,i.SU)(o.Ie),null,{default:(0,l.w5)((function(){return[(0,l.Wm)((0,i.SU)(o.Q$),{position:"floating"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Kode QR")]})),_:1}),(0,l.Wm)((0,i.SU)(o.pK),{modelValue:W.value,"onUpdate:modelValue":r[5]||(r[5]=function(e){return W.value=e}),placeholder:"Hasil scan QR Code",readonly:""},null,8,["modelValue"])]})),_:1}),(0,l.Wm)((0,i.SU)(o.YG),{onClick:P,expand:"block",color:"primary"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Scan QR Code")]})),_:1}),(0,l.Wm)((0,i.SU)(o.YG),{onClick:V,expand:"block",color:"primary"},{default:(0,l.w5)((function(){return[(0,l.Uk)("Daftarkan Kode QR")]})),_:1})]})),_:1}),(0,l.Wm)((0,i.SU)(o.jY),{class:"ion-padding"}),(0,l.Wm)((0,i.SU)(o.Px),{"is-open":H.value.isOpen,message:H.value.message,duration:H.value.duration,color:H.value.color,onDidDismiss:r[6]||(r[6]=function(){return H.value.isOpen=!1})},null,8,["is-open","message","duration","color"])]})),_:1})]})),_:1})}}},U=k,h=U},6706:(e,n,r)=>{e.exports=r.p+"img/avatar.40910a76.png"}}]);
//# sourceMappingURL=4473.a008d301.js.map