"use strict";(self["webpackChunkresep_bunda"]=self["webpackChunkresep_bunda"]||[]).push([[2172],{2172:(e,n,a)=>{a.r(n),a.d(n,{default:()=>k});var t=a(124),u=a(9584),l=a(3144),r=a(8534),i=(a(7042),a(7327),a(1539),a(6699),a(2023),a(1249),a(7658),a(2564),a(3112),a(6647),a(3710),a(9714),a(2222),a(6252)),o=a(2262),c=a(3577),s=a(4797),f=a(316),d=a(6100),m=a(5856),v=a(4105),p=(0,i._)("h2",null,"Daftar Pengajuan Izin",-1);const w={__name:"LaporanIzin",setup:function(e){var n=(0,f.v0)(m.H),a=(0,d.ad)(m.H),w=(0,o.iH)([]),S=(0,o.iH)({isOpen:!1,message:"",duration:2e3,color:"success"}),k=(0,o.iH)(!1),U=(0,o.iH)(""),_=(0,o.iH)(""),g=(0,o.iH)(""),h=(0,o.iH)(""),b=(0,o.iH)(10),W=(0,o.iH)(null),z=(0,o.iH)(!1),D=(0,o.iH)(""),y=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}],I=(0,i.Fl)((function(){return w.value.filter((function(e){var n=e.fullName.toLowerCase().includes(h.value.toLowerCase()),a=e.startDate?e.startDate.toDate().getMonth():null,t=""===D.value||a===D.value;return n&&t})).slice(0,b.value)})),j=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(){var n,r,i,o,c,s=arguments;return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=s.length>0&&void 0!==s[0]&&s[0],r=n?(0,d.IO)((0,d.hJ)(a,"izin"),(0,d.ar)("fullName",">=",h.value),(0,d.ar)("fullName","<=",h.value+""),(0,d.b9)(b.value)):(0,d.IO)((0,d.hJ)(a,"izin"),(0,d.ar)("fullName",">=",h.value),(0,d.ar)("fullName","<=",h.value+""),(0,d.TQ)(W.value),(0,d.b9)(b.value)),e.prev=2,e.next=5,(0,d.PL)(r);case 5:i=e.sent,o=i.docs.map((function(e){return(0,l.Z)((0,l.Z)({id:e.id},e.data()),{},{startDate:e.data().startDate,endDate:e.data().endDate})})),n?w.value=o:(c=w.value).push.apply(c,(0,u.Z)(o)),W.value=i.docs[i.docs.length-1],z.value=i.docs.length===b.value,console.log("Data izin berhasil diambil:",w.value),e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](2),console.error("Error fetching izin data:",e.t0),A("Terjadi kesalahan saat mengambil data izin","danger");case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),x=function(){j(!0)},C=function(){j()},H=function(e,n){_.value=e,g.value=n,k.value=!0},N=function(){k.value=!1,U.value="",_.value="",g.value=""},Z=function(){var e=(0,r.Z)((0,t.Z)().mark((function e(){return(0,t.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.r7)((0,d.JU)(a,"izin",_.value),{status:g.value,keteranganStatus:U.value});case 3:A("Status pengajuan izin berhasil diubah menjadi ".concat(g.value),"success"),j(!0),N(),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),console.error("Error updating izin status:",e.t0),A("Terjadi kesalahan saat mengubah status izin","danger");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Y=function(e){setTimeout((function(){j(!0),e.target.complete()}),2e3)},A=function(e,n){S.value={isOpen:!0,message:e,duration:2e3,color:n}},G=function(e){if(!e)return"N/A";var n=e.toDate(),a=n.getDate().toString().padStart(2,"0"),t=(n.getMonth()+1).toString().padStart(2,"0"),u=n.getFullYear();return"".concat(a,"/").concat(t,"/").concat(u)},P=function(){var e=I.value.filter((function(e){return"sakit"===e.izinStatus||"izin"===e.izinStatus}));if(0!==e.length){var n=e.map((function(e){return{fullName:e.fullName,role:e.role,izinStatus:e.izinStatus,durasi:e.durasi,keterangan:e.keterangan,fromDate:G(e.startDate),toDate:G(e.endDate),status:e.status,keteranganStatus:e.keteranganStatus}})),a=v.P6.json_to_sheet(n),t=v.P6.book_new();v.P6.book_append_sheet(t,a,"Laporan Izin dan Sakit"),v.NC(t,"laporan_izin_dan_sakit.xlsx"),A("Laporan izin dan sakit berhasil diekspor","success")}else A("Tidak ada data izin atau sakit untuk bulan yang dipilih","warning")};return(0,i.bv)((function(){(0,f.Aj)(n,(function(e){e?j(!0):(console.error("User not authenticated"),A("Pengguna tidak terautentikasi","danger"))}))})),function(e,n){return(0,i.wg)(),(0,i.j4)((0,o.SU)(s._i),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Gu),{mode:"ios"},{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.sr),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.wd),null,{default:(0,i.w5)((function(){return[(0,i.Uk)("Informasi Pengajuan Izin")]})),_:1}),(0,i.Wm)((0,o.SU)(s.oU),{slot:"start","default-href":"/"})]})),_:1})]})),_:1}),(0,i.Wm)((0,o.SU)(s.W2),{fullscreen:!0},{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.nJ),{slot:"fixed",onIonRefresh:n[0]||(n[0]=function(e){return Y(e)})},{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Wo))]})),_:1}),(0,i.Wm)((0,o.SU)(s.W2),{class:"ion-padding"},{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Ie),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Q$),null,{default:(0,i.w5)((function(){return[(0,i.Uk)("Search by Name")]})),_:1}),(0,i.Wm)((0,o.SU)(s.pK),{modelValue:h.value,"onUpdate:modelValue":n[1]||(n[1]=function(e){return h.value=e}),placeholder:"Enter name to search"},null,8,["modelValue"])]})),_:1}),(0,i.Wm)((0,o.SU)(s.Ie),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Q$),null,{default:(0,i.w5)((function(){return[(0,i.Uk)("Bulan")]})),_:1}),(0,i.Wm)((0,o.SU)(s.t9),{modelValue:D.value,"onUpdate:modelValue":n[2]||(n[2]=function(e){return D.value=e}),placeholder:"Pilih Bulan"},{default:(0,i.w5)((function(){return[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)(y,(function(e){return(0,i.Wm)((0,o.SU)(s.n0),{key:e.value,value:e.value},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,c.zw)(e.label),1)]})),_:2},1032,["value"])})),64))]})),_:1},8,["modelValue"])]})),_:1}),(0,i.Wm)((0,o.SU)(s.YG),{style:{color:"white"},expand:"block",onClick:x},{default:(0,i.w5)((function(){return[(0,i.Uk)("Search")]})),_:1}),(0,i.Wm)((0,o.SU)(s.jY),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Nd),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.wI),null,{default:(0,i.w5)((function(){return[p,(0,i.Wm)((0,o.SU)(s.q_),null,{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(I.value,(function(e){return(0,i.wg)(),(0,i.j4)((0,o.SU)(s.Ie),{key:e.id},{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Q$),null,{default:(0,i.w5)((function(){return[(0,i._)("h3",null,(0,c.zw)(e.fullName)+" - "+(0,c.zw)(e.role),1),(0,i._)("p",null,"Status: "+(0,c.zw)(e.izinStatus),1),(0,i._)("p",null,"Durasi: "+(0,c.zw)(e.durasi)+" hari",1),(0,i._)("p",null,"Keterangan: "+(0,c.zw)(e.keterangan),1),(0,i._)("p",null,"Dari: "+(0,c.zw)(G(e.startDate)),1),(0,i._)("p",null,"Sampai: "+(0,c.zw)(G(e.endDate)),1),(0,i._)("p",null,"Status Admin: "+(0,c.zw)(e.status),1),(0,i._)("p",null,"Keterangan Admin: "+(0,c.zw)(e.keteranganStatus),1)]})),_:2},1024),(0,i.Wm)((0,o.SU)(s.YG),{color:"success",onClick:function(n){return H(e.id,"disetujui")}},{default:(0,i.w5)((function(){return[(0,i.Uk)("Setujui")]})),_:2},1032,["onClick"]),(0,i.Wm)((0,o.SU)(s.YG),{color:"danger",onClick:function(n){return H(e.id,"ditolak")}},{default:(0,i.w5)((function(){return[(0,i.Uk)("Tolak")]})),_:2},1032,["onClick"])]})),_:2},1024)})),128))]})),_:1}),z.value?((0,i.wg)(),(0,i.j4)((0,o.SU)(s.YG),{key:0,expand:"block",onClick:C},{default:(0,i.w5)((function(){return[(0,i.Uk)("Load More")]})),_:1})):(0,i.kq)("",!0)]})),_:1})]})),_:1})]})),_:1}),(0,i.Wm)((0,o.SU)(s.YG),{style:{color:"white"},expand:"block",onClick:P},{default:(0,i.w5)((function(){return[(0,i.Uk)("Export Laporan Sakit")]})),_:1})]})),_:1}),(0,i.Wm)((0,o.SU)(s.Px),{"is-open":S.value.isOpen,message:S.value.message,duration:S.value.duration,color:S.value.color,onDidDismiss:n[3]||(n[3]=function(){return S.value.isOpen=!1})},null,8,["is-open","message","duration","color"]),(0,i.Wm)((0,o.SU)(s.ki),{"is-open":k.value,onDidDismiss:N},{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Gu),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.sr),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.wd),null,{default:(0,i.w5)((function(){return[(0,i.Uk)("Ubah Status Izin")]})),_:1}),(0,i.Wm)((0,o.SU)(s.Sm),{slot:"end"},{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.YG),{onClick:N},{default:(0,i.w5)((function(){return[(0,i.Uk)("Close")]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,i.Wm)((0,o.SU)(s.W2),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Ie),null,{default:(0,i.w5)((function(){return[(0,i.Wm)((0,o.SU)(s.Q$),null,{default:(0,i.w5)((function(){return[(0,i.Uk)("Keterangan")]})),_:1}),(0,i.Wm)((0,o.SU)(s.g2),{modelValue:U.value,"onUpdate:modelValue":n[4]||(n[4]=function(e){return U.value=e}),placeholder:"Masukkan keterangan"},null,8,["modelValue"])]})),_:1}),(0,i.Wm)((0,o.SU)(s.YG),{expand:"block",onClick:Z},{default:(0,i.w5)((function(){return[(0,i.Uk)("Simpan")]})),_:1})]})),_:1})]})),_:1},8,["is-open"])]})),_:1})]})),_:1})}}},S=w,k=S},9584:(e,n,a)=>{a.d(n,{Z:()=>o});a(9753);var t=a(9227);function u(e){if(Array.isArray(e))return(0,t.Z)(e)}a(2526),a(1817),a(1539),a(2165),a(8783),a(3948),a(1038);function l(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var r=a(2780);a(1703),a(6647);function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e){return u(e)||l(e)||(0,r.Z)(e)||i()}}}]);
//# sourceMappingURL=2172.cec38ae1.js.map